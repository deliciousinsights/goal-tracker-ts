<!DOCTYPE html><html lang="en"><head><title>lib/helpers.spec</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content="../"><meta name="groc-document-path" content="lib/helpers.spec"><meta name="groc-project-path" content="src/lib/helpers.spec.ts"><link rel="stylesheet" type="text/css" media="all" href="../assets/style.css"><script type="text/javascript" src="../assets/behavior.js"></script><body><div id="meta"><div class="file-path">src/lib/helpers.spec.ts</div></div><div id="document"><div class="segment"><div class="comments "><div class="wrapper"><h1 id="utilitaires-tests">Utilitaires (tests)</h1></div></div></div><div class="segment"><div class="code"><div class="wrapper"><span class="hljs-keyword">import</span> { subDays } from <span class="hljs-string">'date-fns'</span>

<span class="hljs-keyword">import</span> { formatDate, getDayCounts, isoDate } from <span class="hljs-string">'./helpers'</span>
<span class="hljs-keyword">import</span> { mockGoal } from <span class="hljs-string">'../testHelpers'</span>

describe(<span class="hljs-string">'formatDate'</span>, () =&gt; {
  it(<span class="hljs-string">'should render today properly'</span>, () =&gt; {
    <span class="hljs-keyword">const</span> today = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>()
    expect(formatDate(today)).toBe(<span class="hljs-string">'Aujourdâ€™hui'</span>)
  })

  it(<span class="hljs-string">'should render yesterday properly'</span>, () =&gt; {
    <span class="hljs-keyword">const</span> yesterday = subDays(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(), <span class="hljs-number">1</span>)
    expect(formatDate(yesterday)).toBe(<span class="hljs-string">'Hier'</span>)
  })

  it(<span class="hljs-string">'should render the day before yesterday properly'</span>, () =&gt; {
    <span class="hljs-keyword">const</span> twoDaysAgo = subDays(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(), <span class="hljs-number">2</span>)
    expect(formatDate(twoDaysAgo)).toBe(<span class="hljs-string">'Avant-hier'</span>)
  })

  it(<span class="hljs-string">'should render any other date with a long date form'</span>, () =&gt; {
    expect(formatDate(<span class="hljs-string">'2016-03-03'</span>, <span class="hljs-literal">null</span>, { refDate: <span class="hljs-string">'2016-03-06'</span> })).toBe(
      <span class="hljs-string">'jeudi 3 mars 2016'</span>
    )
  })

  it(<span class="hljs-string">'should honor a custom format in French, if provided'</span>, () =&gt; {
    expect(formatDate(<span class="hljs-string">'2016-03-06'</span>, <span class="hljs-string">'medium'</span>)).toBe(<span class="hljs-string">'6 mars 2016'</span>)
  })
})

describe(<span class="hljs-string">'getDayCounts'</span>, () =&gt; {
  <span class="hljs-keyword">const</span> goals = [
    mockGoal({ id: <span class="hljs-string">'0'</span>, target: <span class="hljs-number">10</span> }),
    mockGoal({ id: <span class="hljs-string">'1'</span>, target: <span class="hljs-number">5</span> }),
    mockGoal({ id: <span class="hljs-string">'2'</span>, target: <span class="hljs-number">27</span> }),
  ]

  it(<span class="hljs-string">'should properly compute totals on full progress info'</span>, () =&gt; {
    expect(getDayCounts({ <span class="hljs-number">0</span>: <span class="hljs-number">1</span>, <span class="hljs-number">1</span>: <span class="hljs-number">2</span>, <span class="hljs-number">2</span>: <span class="hljs-number">3</span> }, goals)).toEqual({
      totalProgress: <span class="hljs-number">6</span>,
      totalTarget: <span class="hljs-number">42</span>,
    })
  })

  it(<span class="hljs-string">'should properly compute totals on partial progress info'</span>, () =&gt; {
    expect(getDayCounts({ <span class="hljs-number">0</span>: <span class="hljs-number">1</span>, <span class="hljs-number">2</span>: <span class="hljs-number">3</span> }, goals)).toEqual({
      totalProgress: <span class="hljs-number">4</span>,
      totalTarget: <span class="hljs-number">42</span>,
    })
  })

  it(<span class="hljs-string">'should properly compute zero totals on empty progress info'</span>, () =&gt; {
    expect(getDayCounts({}, goals)).toEqual({
      totalProgress: <span class="hljs-number">0</span>,
      totalTarget: <span class="hljs-number">42</span>,
    })
  })

  it(<span class="hljs-string">'should properly compute zero totals on empty goals'</span>, () =&gt; {
    expect(getDayCounts({}, [])).toEqual({ totalProgress: <span class="hljs-number">0</span>, totalTarget: <span class="hljs-number">0</span> })
    expect(getDayCounts({ <span class="hljs-number">0</span>: <span class="hljs-number">1</span>, <span class="hljs-number">1</span>: <span class="hljs-number">2</span>, <span class="hljs-number">2</span>: <span class="hljs-number">3</span> }, [])).toEqual({
      totalProgress: <span class="hljs-number">0</span>,
      totalTarget: <span class="hljs-number">0</span>,
    })
  })
})

describe(<span class="hljs-string">'isoDate'</span>, () =&gt; {
  it(<span class="hljs-string">'should properly format its argument'</span>, () =&gt; {
    expect(isoDate(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-number">0</span>))).toEqual(<span class="hljs-string">'1970-01-01'</span>)
  })
})</div></div></div></div></body></html>